<% if(page && page.title && config.disqus_id) { %>
<div class="disqus line">
  <div>
    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function () {
        this.page.url = "<%- page.permalink	 %>";
        this.page.identifier = "<%- page.path %>";
        this.page.title = "<%- page.title %>";
      };
      const loadDisqus = () => {
        // DON'T EDIT BELOW THIS LINE
        var d = document,
          s = d.createElement("script");

        s.type = "text/javascript";
        s.async = true;
        var shortname = "<%- config.disqus_id %>";

        s.src = "//" + shortname + ".disqus.com/embed.js";

        s.setAttribute("data-timestamp", +new Date());
        (d.head || d.body).appendChild(s);
      };
      const onScroll = () => {
        const dom = document.querySelector('.disqus');
        if (window.outerHeight + window.scrollY > dom.offsetTop) {
          window.removeEventListener('scroll', onScroll);
          loadDisqus();
        }
      }
      window.addEventListener('scroll', onScroll)
    </script>
  </div>
</div>

<% } %>